%-------------------------------------------------------------------------------
%   PACKAGE INFORMATION
%-------------------------------------------------------------------------------

% File name: spl-thesis.sty
% Author: Sean Leather <sean.leather@gmail.com>

% (1) Since we are loading 'unicode-math', this package must be loaded /after/
%     'amssymb' and 'amsmath'. Note that polycode.fmt from lhs2TeX loads
%     'amsmath' and other packages.


%-------------------------------------------------------------------------------
%   GENERAL
%-------------------------------------------------------------------------------

\ProvidesPackage{spl-thesis}[2013/12/04 v0.2 SPL thesis]

% This class is for use with XeTeX.
\RequirePackage{ifxetex}
\RequireXeTeX


%-------------------------------------------------------------------------------
%   FONTS FOR TEXT
%-------------------------------------------------------------------------------

% Unicode fonts
\RequirePackage{fontspec}

% Default features
\defaultfontfeatures{Scale=MatchLowercase,Ligatures=TeX}

% Main font
\setmainfont{Garamond Premier Pro}

% Sans-serif font
\setsansfont{Optima}

% Monospaced/Teletype font
\setmonofont{Roboto Slab}


%-------------------------------------------------------------------------------
%   FONTS FOR MATH
%-------------------------------------------------------------------------------

% Extension of 'amsmath': \cramped, \vcentcolon, \lparen, \rparen, etc.
\RequirePackage{mathtools}

% Unicode fonts for text and math (cannot be followed by 'amsmath')
\RequirePackage{unicode-math}

% Default math font
\setmathfont{Asana Math}
\setmathfont[range=\mathsfup,Scale=0.97]{Asana Math}
\setmathfont[range=\mathbfsfup,Scale=0.95]{Asana Math}

% Upright/roman math font
\setmathfont[range=\mathup]{Garamond Premier Pro}

% Caligraphic math font
\setmathfont[range={\mathcal,\mathbfcal},StylisticSet=1]{XITS Math}

% Monospaced/Teletype math font
\setmathfont[range=\mathtt->\mathup]{Roboto Slab}
\newfontfamily{\robotoslabfamily}{Roboto Slab}
\newfontfamily{\robotoslabboldfamily}{Roboto Slab Bold}
\setmathfont[range=\mathstraightquote]{Roboto Slab}


%-------------------------------------------------------------------------------
%   SYMBOLS
%-------------------------------------------------------------------------------

% For \stackbin
\usepackage{stackrel}

% These look better:
\setmathfont[range={\doubleplus}]{XITS Math} % ++
\setmathfont[range={\Coloneq}]{EB Garamond 12 Regular} % ::=
\setmathfont[range={\smwhtdiamond}]{TeX Gyre Pagella Math} % <>


%-------------------------------------------------------------------------------
%   HYPERLINKS
%-------------------------------------------------------------------------------

\RequirePackage{hyperref}
\RequirePackage{url}


%-------------------------------------------------------------------------------
%   TABLES
%-------------------------------------------------------------------------------

\RequirePackage{tabularx}


%-------------------------------------------------------------------------------
%   LISTS
%-------------------------------------------------------------------------------

\RequirePackage{enumitem}

\setlist[enumerate]{leftmargin=2\parindent}
\setlist[itemize]{leftmargin=2\parindent}


%-------------------------------------------------------------------------------
%   INFERENCE RULES
%-------------------------------------------------------------------------------

\usepackage{mathpartir}


%-------------------------------------------------------------------------------
%   THEOREMS
%-------------------------------------------------------------------------------

\usepackage[thmmarks,thref,amsmath,hyperref]{ntheorem}

\theoremnumbering{arabic}

% Definition
\theoremstyle{plain}
\theoremheaderfont{\normalfont\bfseries}
\theorembodyfont{\slshape}
\theoremseparator{.}
\theoremsymbol{\ensuremath{\bullet}}
\newtheorem{Definition}{Definition}

% Theorem and Lemma
\theoremstyle{plain}
\theoremheaderfont{\normalfont\bfseries}
\theorembodyfont{\slshape}
\theoremsymbol{\ensuremath{\scriptscriptstyle\square}}
\theoremseparator{.}
\newtheorem{Theorem}{Theorem}
\newtheorem{Lemma}{Lemma}

% Proof
\theoremstyle{nonumberplain}
\theoremheaderfont{\sc}
\theorembodyfont{\upshape}
\theoremseparator{}
\theoremsymbol{\ensuremath{\scriptscriptstyle\blacksquare}}
\newtheorem{Proof}{Proof}

% Case
\makeatletter
\newtheoremstyle{nonumbernobrackets}%
  {\item[\theorem@@headerfont\hskip\labelsep ##1\theorem@@separator]}%
  {\item[\theorem@@headerfont\hskip\labelsep ##1\ ##3\theorem@@separator]}
\makeatother

\theoremstyle{nonumbernobrackets}
\theoremindent0cm
\theoremseparator{}
\newtheorem{Case}{Case}


%-------------------------------------------------------------------------------
%   MATH
%-------------------------------------------------------------------------------

% Equation label
\newcommand{\eqlabel}[1]{\ensuremath{\textsc{#1}}}

% Math keyword
\newcommand{\Keyword}[1]{\ensuremath{\text{\robotoslabboldfamily{}#1}}}

% Syntax identifiers
\newcommand{\Synid}[1]{\ensuremath{\mathsfup{#1}}}

% Meta identifiers
\newcommand{\Metaid}[1]{\ensuremath{#1}}

% Override lhs2TeX
\renewcommand{\Varid}[1]{\ensuremath{\mathtt{#1}}}
\renewcommand{\Conid}[1]{\ensuremath{\mathtt{#1}}}


%-------------------------------------------------------------------------------
%   BIBLIOGRAPHY
%-------------------------------------------------------------------------------

\RequirePackage{natbib}


%-------------------------------------------------------------------------------
%   ABBREVIATIONS
%-------------------------------------------------------------------------------

\newcommand{\ttt}{type-and-transform}
\newcommand{\tts}{type-and-transform system}
\newcommand{\ttss}{type-and-transform systems}
\newcommand{\Ttss}{Type-and-transform systems}
\newcommand{\TTS}{Type-and-Transform System}
\newcommand{\TTSS}{Type-and-Transform Systems}
\newcommand{\ww}{worker/\allowbreak{}wrapper}

